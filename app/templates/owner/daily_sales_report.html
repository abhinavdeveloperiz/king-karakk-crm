{% extends "base.html" %}
{% block content %}

<div class="space-y-10">

    <!-- HEADER -->
    <div class="flex items-center justify-between">
        <h1 class="text-2xl sm:text-3xl font-bold text-gray-900 uppercase">
            Daily Branch Report â€“ {{ today|date:"M d, Y" }}
        </h1>
    </div>

    {% for branch, data in branch_data.items %}
    <div class="bg-white rounded-2xl shadow-md p-6 space-y-4">

        <!-- Branch Name -->
        <h2 class="text-xl font-semibold text-gray-800 flex items-center gap-2">
            <i data-lucide="store" class="w-5 h-5 text-indigo-600"></i>
            {{ branch.name }}
        </h2>

        <!-- Transactions Table -->
        <div class="overflow-x-auto">
            <table class="min-w-full border-collapse">
                <thead class="bg-gray-50">
                    <tr class="text-xs uppercase text-gray-500">
                        <th class="px-4 py-3 text-center">Time</th>
                        <th class="px-4 py-3 text-center">Type</th>
                        <th class="px-4 py-3 text-center">Amount (BD)</th>
                        <th class="px-4 py-3 text-center">Narration</th>
                    </tr>
                </thead>

                <tbody class="divide-y text-sm">
                    {% for t in data.transactions %}
                    <tr class="hover:bg-gray-50">

                        <td class="px-4 py-3 text-center whitespace-nowrap">
                            {{ t.created_on|date:"h:i A" }}
                        </td>

                        <td class="px-4 py-3 text-center font-medium
                            {% if t.transaction_type == 'SALE' %} text-green-600
                            {% elif t.transaction_type == 'EXPENSE' %} text-red-600
                            {% else %} text-purple-600 {% endif %}
                        ">
                            {{ t.transaction_type }}
                        </td>

                        <td class="px-4 py-3 text-center font-semibold whitespace-nowrap
                            {% if t.transaction_type == 'SALE' %} text-green-600
                            {% elif t.transaction_type == 'EXPENSE' %} text-red-600
                            {% else %} text-purple-600 {% endif %}
                        ">
                            BD {{ t.amount|floatformat:2 }}
                        </td>

                        <td class="px-4 py-3 text-center text-gray-600">
                            {{ t.description|default:"NULL" }}
                        </td>

                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4" class="py-6 text-center text-gray-500">
                            No transactions today
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- CASH BALANCE -->
        <div class="pt-4 border-t">
            <div class="flex items-center justify-between">
                <span class="text-base font-semibold text-gray-700">
                    Cash Balance:
                </span>

                <span class="text-lg font-bold
            {% if data.balance >= 0 %}
                text-green-600
            {% else %}
                text-red-600
            {% endif %}
        ">
                    BD {{ data.balance|floatformat:2 }}
                </span>
            </div>
        </div>


    </div>
    {% empty %}
    <div class="text-center py-10 text-gray-500">
        No transactions recorded today.
    </div>
    {% endfor %}

</div>

<script>
    lucide.createIcons();
</script>

{% endblock %}